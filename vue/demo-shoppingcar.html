<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Vue-购物车</title>
    <script src="//cdn.bootcss.com/vue/1.0.26/vue.min.js"></script>
    <link href="//cdn.bootcss.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div id="app" class="container">
    <div class="table-responsive">
        <table class="table table-hover">
            <caption class="text-center">
                <span class="glyphicon glyphicon-shopping-cart"></span>&nbsp;欢迎使用我的购物车
            </caption>
            <thead>
            <tr>
                <th>商品编号</th>
                <th>商品名称</th>
                <th>购买数量</th>
                <th>商品单价</th>
                <th>商品总价</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr v-for="product in data">
                <td>{{product.id}}</td>
                <td>{{product.name}}</td>
                <td class="row col-lg-2">
                    <div class="input-group col-lg-8">
                        <span class="input-group-btn">
                            <button class="btn btn-info" :class="{disabled: product.quantity == 1}" @click="reduce($index)">-</button>
                        </span>
                        <input type="text" class="form-control" value="{{product.quantity }}" v-model="product.quantity"/>
                        <span class="input-group-btn">
                            <button class="btn btn-info" :class="{disabled: product.quantity == 10}" @click="add($index)">+</button>
                        </span>
                    </div>
                </td>
                <td>{{product.price }}</td>
                <td>{{product.price * product.quantity}}</td>
                <td>
                    <button class="btn btn-danger" @click="remove($index)">移除</button>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <strong>总购买数: {{totalQuantity}}</strong>
                </td>
                <td colspan="2">
                    <strong>合计金额: {{totalPrice}}</strong>
                </td>
                <td>
                    <button class="btn btn-danger" @click="removeAll()">清空购物车</button>
                </td>
                <td>
                    <button class="btn btn-success" @click="pay()">去结算</button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<script type="text/javascript">

    new Vue({
        el: '#app',
        data: {
            data: [
                {
                    id:1000001,
                    name:'康师傅桶面',
                    quantity:2,
                    price:5.5
                },{
                    id:1000091,
                    name:'今麦郎弹面',
                    quantity:3,
                    price:7.5
                },{
                    id:1000201,
                    name:'统一老坛酸菜牛肉面',
                    quantity:7,
                    price:8
                }, {
                    id: 1003335,
                    name: '超级福满多',
                    quantity: 5,
                    price: 3
                }
            ]
        },
        computed: {
            // 总金额
            totalPrice: function(){
                var price = 0;
                for(var i = 0; i < this.data.length; i++){
                    var self = this.data[i];
                    price += self.price * self.quantity;
                }
                return price;
            },
            // 总商品数量
            totalQuantity: function(){
                  var total = 0;
                for(var i = 0; i < this.data.length; i++){
                    var self = this.data[i];
                    //console.log(self.quantity);
                    console.log(typeof(self.quantity*1));
                    total += self.quantity*1;
                }
                return total;
            }
        },
        methods: {
            // 删除商品数量
            reduce: function(index){
                var product = this.data[index];
                if(product.quantity == 1){
                    return false;
                }
                product.quantity--;
            },
            // 添加商品数量
            add: function(index){
                var product = this.data[index];
                if(product.quantity == 10){
                    return false;
                }
                product.quantity++;
            },
            // 移除商品
            remove: function(index){
                this.data.splice(index, 1);
            },
            // 清空购物车
            removeAll: function(){
                this.data = [];
            },
            // 结算
            pay: function(){
                alert('待实现');
            }

        }
    });

</script>
</body>
</html>